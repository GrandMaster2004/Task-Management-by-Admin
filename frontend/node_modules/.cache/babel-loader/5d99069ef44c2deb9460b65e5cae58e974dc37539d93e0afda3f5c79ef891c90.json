{"ast":null,"code":"\"use client\";import{useState,useEffect}from\"react\";import{Users,CheckCircle,Clock,Menu,X,LogOut,Home,PlusCircle,Edit,Trash2,UserPlus,UserMinus,Mail,ListTodo,UserX}from\"lucide-react\";import{useAuth}from\"../context/AuthContext\";import apiService from\"../services/api\";import TaskModal from\"./TaskModal\";import TaskAssignModal from\"./TaskAssignModal\";import UserModal from\"./UserModal\";import EmailModal from\"./EmailModal\";import{format}from\"date-fns\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const SubAdminDashboard=()=>{var _user$name,_subAdminPermissions$5,_subAdminPermissions$6,_subAdminPermissions$7;const{user,logout,refreshUser}=useAuth();const[users,setUsers]=useState([]);const[tasks,setTasks]=useState([]);const[loading,setLoading]=useState(true);const[activeView,setActiveView]=useState(\"overview\");const[sidebarOpen,setSidebarOpen]=useState(false);const[error,setError]=useState(null);// Modals state\nconst[showTaskModal,setShowTaskModal]=useState(false);const[editingTask,setEditingTask]=useState(null);const[showTaskAssignModal,setShowTaskAssignModal]=useState(false);const[showUserModal,setShowUserModal]=useState(false);const[editingUser,setEditingUser]=useState(null);const[showEmailModal,setShowEmailModal]=useState(false);const[emailRecipients,setEmailRecipients]=useState([]);// Task filtering\nconst[activeTimeline,setActiveTimeline]=useState(\"all\");// all, today, week, month, deadline-missed\nconst[activeTaskFilter,setActiveTaskFilter]=useState(\"all\");// all, pending, completed\nconst subAdminPermissions=(user===null||user===void 0?void 0:user.permissions)||{};useEffect(()=>{fetchData();},[user,activeTimeline,activeTaskFilter]);// Re-fetch if user permissions change or filters change\nconst fetchData=async()=>{try{var _subAdminPermissions$,_subAdminPermissions$2;setLoading(true);setError(null);let fetchedUsers=[];let fetchedTasks=[];// Fetch users based on permissions\nif(subAdminPermissions.canViewAllUsers){const usersRes=await apiService.getAllUsers();if(usersRes.success){fetchedUsers=usersRes.users||[];}else{setError(usersRes.message);}}else if(((_subAdminPermissions$=subAdminPermissions.canViewSpecificUsers)===null||_subAdminPermissions$===void 0?void 0:_subAdminPermissions$.length)>0){// If canViewSpecificUsers is defined and not empty, fetch only those users\n// This would require a backend endpoint like /subadmin/users?ids=...\n// For now, we'll filter from all users if we fetch them, or assume backend handles it.\n// If backend doesn't filter, we might need to fetch all and filter on frontend,\n// but that's less efficient for large datasets.\nconst usersRes=await apiService.getAllUsers();// Assuming backend filters based on subadmin token\nif(usersRes.success){fetchedUsers=usersRes.users.filter(u=>subAdminPermissions.canViewSpecificUsers.includes(u._id));}else{setError(usersRes.message);}}// Fetch tasks based on permissions\nif(subAdminPermissions.canViewAllTasks){const tasksRes=await apiService.getAllTasks();if(tasksRes.success){fetchedTasks=tasksRes.tasks||[];}else{setError(tasksRes.message);}}else if(((_subAdminPermissions$2=subAdminPermissions.canViewSpecificUsers)===null||_subAdminPermissions$2===void 0?void 0:_subAdminPermissions$2.length)>0){// Fetch tasks assigned to users this subadmin can view\n// This would ideally be a specific backend endpoint for subadmins\nconst tasksRes=await apiService.getAllTasks();// Assuming backend filters based on subadmin token\nif(tasksRes.success){fetchedTasks=tasksRes.tasks.filter(task=>{var _task$assignedTo;return subAdminPermissions.canViewSpecificUsers.includes(((_task$assignedTo=task.assignedTo)===null||_task$assignedTo===void 0?void 0:_task$assignedTo._id)||task.assignedTo);});}else{setError(tasksRes.message);}}else{// If no specific or global view permissions, subadmin can only see their own assigned tasks\nconst tasksRes=await apiService.getTasks();// This fetches tasks assigned to the current user (subadmin)\nif(tasksRes.success){fetchedTasks=tasksRes.tasks||[];}else{setError(tasksRes.message);}}setUsers(fetchedUsers);setTasks(fetchedTasks);}catch(error){console.error(\"Failed to fetch data:\",error);setError(error.message||\"An unexpected error occurred.\");}finally{setLoading(false);}};const getStats=()=>{const totalTasks=tasks.length;const completedTasks=tasks.filter(task=>task.completed).length;const pendingTasks=totalTasks-completedTasks;const totalUsers=users.length;const unassignedUsers=users.filter(user=>!user.assignedTasks||user.assignedTasks.length===0).length;return{totalTasks,completedTasks,pendingTasks,totalUsers,unassignedUsers};};const stats=getStats();const getTimelineData=()=>{const now=new Date();let filteredTasks=tasks;if(activeTimeline===\"today\"){filteredTasks=filteredTasks.filter(task=>{const dueDate=new Date(task.dueDate);return dueDate.toDateString()===now.toDateString();});}else if(activeTimeline===\"week\"){const startOfWeek=new Date(now.setDate(now.getDate()-now.getDay()));const endOfWeek=new Date(now.setDate(now.getDate()-now.getDay()+6));filteredTasks=filteredTasks.filter(task=>{const dueDate=new Date(task.dueDate);return dueDate>=startOfWeek&&dueDate<=endOfWeek;});}else if(activeTimeline===\"month\"){filteredTasks=filteredTasks.filter(task=>{const dueDate=new Date(task.dueDate);return dueDate.getMonth()===now.getMonth()&&dueDate.getFullYear()===now.getFullYear();});}else if(activeTimeline===\"deadline-missed\"){filteredTasks=filteredTasks.filter(task=>{const dueDate=new Date(task.dueDate);return!task.completed&&dueDate<now;});}if(activeTaskFilter===\"pending\"){filteredTasks=filteredTasks.filter(task=>!task.completed);}else if(activeTaskFilter===\"completed\"){filteredTasks=filteredTasks.filter(task=>task.completed);}return filteredTasks;};const filteredTasks=getTimelineData();const handleSaveTask=async function(taskData){let taskId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;try{let response;if(taskId){response=await apiService.updateTask(taskId,taskData);}else{response=await apiService.createTask(taskData);}if(response.success){setError(null);setShowTaskModal(false);setEditingTask(null);fetchData();// Refresh data\n}else{setError(response.message);}}catch(err){setError(err.message||\"Failed to save task.\");}};const handleDeleteTask=async taskId=>{if(window.confirm(\"Are you sure you want to delete this task?\")){try{const response=await apiService.deleteTask(taskId);if(response.success){setError(null);fetchData();// Refresh data\n}else{setError(response.message);}}catch(err){setError(err.message||\"Failed to delete task.\");}}};const handleAssignTask=async(taskId,userId)=>{try{const response=await apiService.assignTask(taskId,userId);if(response.success){setError(null);fetchData();}else{setError(response.message);}}catch(err){setError(err.message||\"Failed to assign task.\");}};const handleUnassignTask=async taskId=>{if(window.confirm(\"Are you sure you want to unassign this task?\")){try{const response=await apiService.unassignTask(taskId);if(response.success){setError(null);fetchData();}else{setError(response.message);}}catch(err){setError(err.message||\"Failed to unassign task.\");}}};const handleCreateAndAssignTask=async taskData=>{try{const response=await apiService.createTask(taskData);// This endpoint should handle assignment if assignedTo is present\nif(response.success){setError(null);setShowTaskAssignModal(false);fetchData();}else{setError(response.message);}}catch(err){setError(err.message||\"Failed to create and assign task.\");}};const handleSaveUser=async function(userData){let userId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;try{let response;if(userId){response=await apiService.updateUser(userId,userData);}else{response=await apiService.createUser(userData);}if(response.success){setError(null);setShowUserModal(false);setEditingUser(null);fetchData();// Refresh data\n}else{setError(response.message);}}catch(err){setError(err.message||\"Failed to save user.\");}};const handleDeleteUser=async userId=>{if(window.confirm(\"Are you sure you want to delete this user?\")){try{const response=await apiService.deleteUser(userId);if(response.success){setError(null);fetchData();// Refresh data\n}else{setError(response.message);}}catch(err){setError(err.message||\"Failed to delete user.\");}}};const handleSendEmail=async emailData=>{try{const response=await apiService.sendEmail(emailData);if(response.success){setError(null);setShowEmailModal(false);alert(\"Email sent successfully!\");}else{setError(response.message);}}catch(err){setError(err.message||\"Failed to send email.\");}};const renderOverview=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-blue-600 dark:text-blue-400\",children:stats.totalTasks}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300\",children:\"Total Tasks\"})]}),/*#__PURE__*/_jsx(ListTodo,{className:\"text-blue-500\",size:24})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-orange-600 dark:text-orange-400\",children:stats.pendingTasks}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300\",children:\"Pending Tasks\"})]}),/*#__PURE__*/_jsx(Clock,{className:\"text-orange-500\",size:24})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-green-600 dark:text-green-400\",children:stats.completedTasks}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300\",children:\"Completed Tasks\"})]}),/*#__PURE__*/_jsx(CheckCircle,{className:\"text-green-500\",size:24})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors\",onClick:()=>subAdminPermissions.canViewAllUsers&&setActiveView(\"manage-users\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-purple-600 dark:text-purple-400\",children:stats.totalUsers}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300\",children:\"Total Users\"})]}),/*#__PURE__*/_jsx(Users,{className:\"text-purple-500\",size:24})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors\",onClick:()=>subAdminPermissions.canViewAllUsers&&setActiveView(\"unassigned-users\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-red-600 dark:text-red-400\",children:stats.unassignedUsers}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300\",children:\"Unassigned Users\"})]}),/*#__PURE__*/_jsx(UserX,{className:\"text-red-500\",size:24})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4\",children:\"Recent Users\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:users.slice(0,5).map(user=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-sm font-semibold\",children:user.name.charAt(0)})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-800 dark:text-gray-100\",children:user.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-300\",children:user.email})]})]}),/*#__PURE__*/_jsx(\"span\",{className:`px-2 py-1 rounded-full text-xs font-medium ${user.role===\"admin\"?\"bg-red-100 text-red-600 dark:bg-red-800 dark:text-red-200\":user.role===\"subadmin\"?\"bg-blue-100 text-blue-600 dark:bg-blue-800 dark:text-blue-200\":\"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-200\"}`,children:user.role})]},user._id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4\",children:\"Recent Tasks\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:tasks.slice(0,5).map(task=>{var _task$assignedTo2;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-800 dark:text-gray-100\",children:task.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-300\",children:[\"Assigned to: \",((_task$assignedTo2=task.assignedTo)===null||_task$assignedTo2===void 0?void 0:_task$assignedTo2.name)||\"Unassigned\"]})]}),/*#__PURE__*/_jsx(\"span\",{className:`px-2 py-1 rounded-full text-xs font-medium transition-colors ${task.completed?\"bg-green-100 text-green-600 dark:bg-green-800 dark:text-green-200\":\"bg-orange-100 text-orange-600 dark:bg-orange-800 dark:text-orange-200\"}`,children:task.completed?\"Completed\":\"Pending\"})]},task._id);})})]})]})]});const renderManageTasks=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 dark:text-gray-100\",children:\"Manage Tasks\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:[\"all\",\"today\",\"week\",\"month\",\"deadline-missed\"].map(timeline=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTimeline(timeline),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${activeTimeline===timeline?\"bg-purple-600 text-white\":\"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600\"}`,children:timeline.charAt(0).toUpperCase()+timeline.slice(1).replace(\"-\",\" \")},timeline))}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:[\"all\",\"pending\",\"completed\"].map(filter=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTaskFilter(filter),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${activeTaskFilter===filter?\"bg-blue-600 text-white\":\"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600\"}`,children:filter.charAt(0).toUpperCase()+filter.slice(1)},filter))}),activeTimeline===\"deadline-missed\"&&subAdminPermissions.canSendEmails&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{const missedDeadlineUsers=filteredTasks.filter(task=>{var _task$assignedTo3;return(_task$assignedTo3=task.assignedTo)===null||_task$assignedTo3===void 0?void 0:_task$assignedTo3.email;}).map(task=>task.assignedTo.email);setEmailRecipients([...new Set(missedDeadlineUsers)]);// Unique emails\nsetShowEmailModal(true);},className:\"px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-medium hover:bg-red-600 transition-colors\",children:[/*#__PURE__*/_jsx(Mail,{size:16,className:\"inline-block mr-2\"}),\"Email Users\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-700 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 p-6\",children:filteredTasks.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300 text-center\",children:\"No tasks found for this filter.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-gray-600\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 dark:bg-gray-800\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Assigned To\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Due Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Priority\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600\",children:filteredTasks.map(task=>{var _task$assignedTo4,_subAdminPermissions$3;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100\",children:task.title}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\",children:((_task$assignedTo4=task.assignedTo)===null||_task$assignedTo4===void 0?void 0:_task$assignedTo4.name)||\"Unassigned\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\",children:task.dueDate?format(new Date(task.dueDate),\"PPP\"):\"N/A\"}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\",children:task.priority}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${task.completed?\"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100\":\"bg-orange-100 text-orange-800 dark:bg-orange-800 dark:text-orange-100\"}`,children:task.completed?\"Completed\":\"Pending\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\",children:(subAdminPermissions.canEditAllTasks||task.assignedTo&&((_subAdminPermissions$3=subAdminPermissions.canEditSpecificUsers)===null||_subAdminPermissions$3===void 0?void 0:_subAdminPermissions$3.includes(task.assignedTo._id)))&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setEditingTask(task);setShowTaskModal(true);},className:\"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 mr-3\",title:\"Edit Task\",children:/*#__PURE__*/_jsx(Edit,{size:18})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteTask(task._id),className:\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 mr-3\",title:\"Delete Task\",children:/*#__PURE__*/_jsx(Trash2,{size:18})}),task.assignedTo&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleUnassignTask(task._id),className:\"text-yellow-600 hover:text-yellow-900 dark:text-yellow-400 dark:hover:text-yellow-200\",title:\"Unassign Task\",children:/*#__PURE__*/_jsx(UserMinus,{size:18})})]})})]},task._id);})})]})})})]});const renderManageUsers=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 dark:text-gray-100\",children:\"Manage Users\"}),subAdminPermissions.canEditAllUsers&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setEditingUser(null);setShowUserModal(true);},className:\"px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700 transition-colors\",children:[/*#__PURE__*/_jsx(UserPlus,{size:16,className:\"inline-block mr-2\"}),\"Add New User\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-700 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 p-6\",children:users.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300 text-center\",children:\"No users found.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-gray-600\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 dark:bg-gray-800\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600\",children:users.map(user=>{var _subAdminPermissions$4;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100\",children:user.name}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\",children:user.email}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${user.role===\"admin\"?\"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100\":user.role===\"subadmin\"?\"bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100\":\"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\"}`,children:user.role})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\",children:(subAdminPermissions.canEditAllUsers||((_subAdminPermissions$4=subAdminPermissions.canEditSpecificUsers)===null||_subAdminPermissions$4===void 0?void 0:_subAdminPermissions$4.includes(user._id)))&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setEditingUser(user);setShowUserModal(true);},className:\"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 mr-3\",title:\"Edit User\",children:/*#__PURE__*/_jsx(Edit,{size:18})}),user.role!==\"admin\"&&/*#__PURE__*/// Admins cannot delete other admins\n_jsx(\"button\",{onClick:()=>handleDeleteUser(user._id),className:\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200\",title:\"Delete User\",children:/*#__PURE__*/_jsx(Trash2,{size:18})})]})})]},user._id);})})]})})})]});if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-300\",children:\"Loading subadmin dashboard...\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50 dark:bg-gray-900 flex\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-4 right-4 z-50 bg-red-500 text-white p-4 rounded-lg shadow-lg max-w-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),className:\"ml-2 text-white hover:text-gray-200\",children:/*#__PURE__*/_jsx(X,{size:16})})]})}),sidebarOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden\",onClick:()=>setSidebarOpen(false)}),/*#__PURE__*/_jsx(\"div\",{className:`fixed lg:static inset-y-0 left-0 z-50 w-64 bg-white dark:bg-gray-800 shadow-sm border-r border-gray-200 dark:border-gray-700 transform ${sidebarOpen?\"translate-x-0\":\"-translate-x-full\"} lg:translate-x-0 transition-transform duration-300 ease-in-out`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"T\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xl font-bold text-gray-800 dark:text-gray-100\",children:\"SubAdmin Panel\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSidebarOpen(false),className:\"lg:hidden text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(X,{size:24})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-semibold\",children:user===null||user===void 0?void 0:(_user$name=user.name)===null||_user$name===void 0?void 0:_user$name.charAt(0)})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-800 dark:text-gray-100\",children:user===null||user===void 0?void 0:user.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-purple-500\",children:\"SubAdmin\"})]})]})}),/*#__PURE__*/_jsxs(\"nav\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveView(\"overview\"),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${activeView===\"overview\"?\"bg-purple-50 text-purple-600 dark:bg-purple-900 dark:text-purple-300\":\"text-gray-600 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700\"}`,children:[/*#__PURE__*/_jsx(Home,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Overview\"})]}),(subAdminPermissions.canViewAllTasks||((_subAdminPermissions$5=subAdminPermissions.canViewSpecificUsers)===null||_subAdminPermissions$5===void 0?void 0:_subAdminPermissions$5.length)>0)&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveView(\"manage-tasks\"),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${activeView===\"manage-tasks\"?\"bg-purple-50 text-purple-600 dark:bg-purple-900 dark:text-purple-300\":\"text-gray-600 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700\"}`,children:[/*#__PURE__*/_jsx(ListTodo,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Manage Tasks\"})]}),(subAdminPermissions.canViewAllUsers||((_subAdminPermissions$6=subAdminPermissions.canViewSpecificUsers)===null||_subAdminPermissions$6===void 0?void 0:_subAdminPermissions$6.length)>0)&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveView(\"manage-users\"),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${activeView===\"manage-users\"?\"bg-purple-50 text-purple-600 dark:bg-purple-900 dark:text-purple-300\":\"text-gray-600 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700\"}`,children:[/*#__PURE__*/_jsx(Users,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Manage Users\"})]}),(subAdminPermissions.canEditAllTasks||((_subAdminPermissions$7=subAdminPermissions.canEditSpecificUsers)===null||_subAdminPermissions$7===void 0?void 0:_subAdminPermissions$7.length)>0)&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowTaskAssignModal(true),className:\"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-green-600 hover:bg-green-50 dark:text-green-400 dark:hover:bg-green-900\",children:[/*#__PURE__*/_jsx(PlusCircle,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Assign New Task\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-8\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:logout,className:\"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900\",children:[/*#__PURE__*/_jsx(LogOut,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:\"Logout\"})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6 lg:hidden\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSidebarOpen(true),className:\"text-gray-600 hover:text-gray-800 dark:text-gray-300 dark:hover:text-gray-100\",children:/*#__PURE__*/_jsx(Menu,{size:24})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-gray-800 dark:text-gray-100\",children:\"SubAdmin Dashboard\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-6\"})]}),activeView===\"overview\"&&renderOverview(),activeView===\"manage-tasks\"&&renderManageTasks(),activeView===\"manage-users\"&&renderManageUsers(),activeView===\"unassigned-users\"&&subAdminPermissions.canViewAllUsers&&renderManageUsers(),\" \"]}),showTaskModal&&/*#__PURE__*/_jsx(TaskModal,{task:editingTask,users:users.filter(u=>u.role===\"user\")// Only assign to regular users\n,onClose:()=>{setShowTaskModal(false);setEditingTask(null);},onSave:handleSaveTask}),showTaskAssignModal&&/*#__PURE__*/_jsx(TaskAssignModal,{users:users.filter(u=>u.role===\"user\")// Only assign to regular users\n,onClose:()=>setShowTaskAssignModal(false),onAssign:handleCreateAndAssignTask}),showUserModal&&/*#__PURE__*/_jsx(UserModal,{user:editingUser,onClose:()=>{setShowUserModal(false);setEditingUser(null);},onSave:handleSaveUser}),showEmailModal&&/*#__PURE__*/_jsx(EmailModal,{recipients:emailRecipients,onClose:()=>setShowEmailModal(false),onSend:handleSendEmail})]});};export default SubAdminDashboard;","map":{"version":3,"names":["useState","useEffect","Users","CheckCircle","Clock","Menu","X","LogOut","Home","PlusCircle","Edit","Trash2","UserPlus","UserMinus","Mail","ListTodo","UserX","useAuth","apiService","TaskModal","TaskAssignModal","UserModal","EmailModal","format","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SubAdminDashboard","_user$name","_subAdminPermissions$5","_subAdminPermissions$6","_subAdminPermissions$7","user","logout","refreshUser","users","setUsers","tasks","setTasks","loading","setLoading","activeView","setActiveView","sidebarOpen","setSidebarOpen","error","setError","showTaskModal","setShowTaskModal","editingTask","setEditingTask","showTaskAssignModal","setShowTaskAssignModal","showUserModal","setShowUserModal","editingUser","setEditingUser","showEmailModal","setShowEmailModal","emailRecipients","setEmailRecipients","activeTimeline","setActiveTimeline","activeTaskFilter","setActiveTaskFilter","subAdminPermissions","permissions","fetchData","_subAdminPermissions$","_subAdminPermissions$2","fetchedUsers","fetchedTasks","canViewAllUsers","usersRes","getAllUsers","success","message","canViewSpecificUsers","length","filter","u","includes","_id","canViewAllTasks","tasksRes","getAllTasks","task","_task$assignedTo","assignedTo","getTasks","console","getStats","totalTasks","completedTasks","completed","pendingTasks","totalUsers","unassignedUsers","assignedTasks","stats","getTimelineData","now","Date","filteredTasks","dueDate","toDateString","startOfWeek","setDate","getDate","getDay","endOfWeek","getMonth","getFullYear","handleSaveTask","taskData","taskId","arguments","undefined","response","updateTask","createTask","err","handleDeleteTask","window","confirm","deleteTask","handleAssignTask","userId","assignTask","handleUnassignTask","unassignTask","handleCreateAndAssignTask","handleSaveUser","userData","updateUser","createUser","handleDeleteUser","deleteUser","handleSendEmail","emailData","sendEmail","alert","renderOverview","className","children","size","onClick","slice","map","name","charAt","email","role","_task$assignedTo2","title","renderManageTasks","timeline","toUpperCase","replace","canSendEmails","missedDeadlineUsers","_task$assignedTo3","Set","_task$assignedTo4","_subAdminPermissions$3","priority","canEditAllTasks","canEditSpecificUsers","renderManageUsers","canEditAllUsers","_subAdminPermissions$4","onClose","onSave","onAssign","recipients","onSend"],"sources":["C:/Users/gondy/OneDrive/Desktop/taskflow-frontend/frontend/src/components/SubAdminDashboard.jsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport {\n  Users,\n  CheckCircle,\n  Clock,\n  Menu,\n  X,\n  LogOut,\n  Home,\n  PlusCircle,\n  Edit,\n  Trash2,\n  UserPlus,\n  UserMinus,\n  Mail,\n  ListTodo,\n  UserX,\n} from \"lucide-react\";\nimport { useAuth } from \"../context/AuthContext\";\nimport apiService from \"../services/api\";\nimport TaskModal from \"./TaskModal\";\nimport TaskAssignModal from \"./TaskAssignModal\";\nimport UserModal from \"./UserModal\";\nimport EmailModal from \"./EmailModal\";\nimport { format } from \"date-fns\";\n\nconst SubAdminDashboard = () => {\n  const { user, logout, refreshUser } = useAuth();\n  const [users, setUsers] = useState([]);\n  const [tasks, setTasks] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [activeView, setActiveView] = useState(\"overview\");\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Modals state\n  const [showTaskModal, setShowTaskModal] = useState(false);\n  const [editingTask, setEditingTask] = useState(null);\n  const [showTaskAssignModal, setShowTaskAssignModal] = useState(false);\n  const [showUserModal, setShowUserModal] = useState(false);\n  const [editingUser, setEditingUser] = useState(null);\n  const [showEmailModal, setShowEmailModal] = useState(false);\n  const [emailRecipients, setEmailRecipients] = useState([]);\n\n  // Task filtering\n  const [activeTimeline, setActiveTimeline] = useState(\"all\"); // all, today, week, month, deadline-missed\n  const [activeTaskFilter, setActiveTaskFilter] = useState(\"all\"); // all, pending, completed\n\n  const subAdminPermissions = user?.permissions || {};\n\n  useEffect(() => {\n    fetchData();\n  }, [user, activeTimeline, activeTaskFilter]); // Re-fetch if user permissions change or filters change\n\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      let fetchedUsers = [];\n      let fetchedTasks = [];\n\n      // Fetch users based on permissions\n      if (subAdminPermissions.canViewAllUsers) {\n        const usersRes = await apiService.getAllUsers();\n        if (usersRes.success) {\n          fetchedUsers = usersRes.users || [];\n        } else {\n          setError(usersRes.message);\n        }\n      } else if (subAdminPermissions.canViewSpecificUsers?.length > 0) {\n        // If canViewSpecificUsers is defined and not empty, fetch only those users\n        // This would require a backend endpoint like /subadmin/users?ids=...\n        // For now, we'll filter from all users if we fetch them, or assume backend handles it.\n        // If backend doesn't filter, we might need to fetch all and filter on frontend,\n        // but that's less efficient for large datasets.\n        const usersRes = await apiService.getAllUsers(); // Assuming backend filters based on subadmin token\n        if (usersRes.success) {\n          fetchedUsers = usersRes.users.filter((u) =>\n            subAdminPermissions.canViewSpecificUsers.includes(u._id)\n          );\n        } else {\n          setError(usersRes.message);\n        }\n      }\n\n      // Fetch tasks based on permissions\n      if (subAdminPermissions.canViewAllTasks) {\n        const tasksRes = await apiService.getAllTasks();\n        if (tasksRes.success) {\n          fetchedTasks = tasksRes.tasks || [];\n        } else {\n          setError(tasksRes.message);\n        }\n      } else if (subAdminPermissions.canViewSpecificUsers?.length > 0) {\n        // Fetch tasks assigned to users this subadmin can view\n        // This would ideally be a specific backend endpoint for subadmins\n        const tasksRes = await apiService.getAllTasks(); // Assuming backend filters based on subadmin token\n        if (tasksRes.success) {\n          fetchedTasks = tasksRes.tasks.filter((task) =>\n            subAdminPermissions.canViewSpecificUsers.includes(\n              task.assignedTo?._id || task.assignedTo\n            )\n          );\n        } else {\n          setError(tasksRes.message);\n        }\n      } else {\n        // If no specific or global view permissions, subadmin can only see their own assigned tasks\n        const tasksRes = await apiService.getTasks(); // This fetches tasks assigned to the current user (subadmin)\n        if (tasksRes.success) {\n          fetchedTasks = tasksRes.tasks || [];\n        } else {\n          setError(tasksRes.message);\n        }\n      }\n\n      setUsers(fetchedUsers);\n      setTasks(fetchedTasks);\n    } catch (error) {\n      console.error(\"Failed to fetch data:\", error);\n      setError(error.message || \"An unexpected error occurred.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getStats = () => {\n    const totalTasks = tasks.length;\n    const completedTasks = tasks.filter((task) => task.completed).length;\n    const pendingTasks = totalTasks - completedTasks;\n    const totalUsers = users.length;\n    const unassignedUsers = users.filter(\n      (user) => !user.assignedTasks || user.assignedTasks.length === 0\n    ).length;\n\n    return {\n      totalTasks,\n      completedTasks,\n      pendingTasks,\n      totalUsers,\n      unassignedUsers,\n    };\n  };\n\n  const stats = getStats();\n\n  const getTimelineData = () => {\n    const now = new Date();\n    let filteredTasks = tasks;\n\n    if (activeTimeline === \"today\") {\n      filteredTasks = filteredTasks.filter((task) => {\n        const dueDate = new Date(task.dueDate);\n        return dueDate.toDateString() === now.toDateString();\n      });\n    } else if (activeTimeline === \"week\") {\n      const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay()));\n      const endOfWeek = new Date(now.setDate(now.getDate() - now.getDay() + 6));\n      filteredTasks = filteredTasks.filter((task) => {\n        const dueDate = new Date(task.dueDate);\n        return dueDate >= startOfWeek && dueDate <= endOfWeek;\n      });\n    } else if (activeTimeline === \"month\") {\n      filteredTasks = filteredTasks.filter((task) => {\n        const dueDate = new Date(task.dueDate);\n        return (\n          dueDate.getMonth() === now.getMonth() &&\n          dueDate.getFullYear() === now.getFullYear()\n        );\n      });\n    } else if (activeTimeline === \"deadline-missed\") {\n      filteredTasks = filteredTasks.filter((task) => {\n        const dueDate = new Date(task.dueDate);\n        return !task.completed && dueDate < now;\n      });\n    }\n\n    if (activeTaskFilter === \"pending\") {\n      filteredTasks = filteredTasks.filter((task) => !task.completed);\n    } else if (activeTaskFilter === \"completed\") {\n      filteredTasks = filteredTasks.filter((task) => task.completed);\n    }\n\n    return filteredTasks;\n  };\n\n  const filteredTasks = getTimelineData();\n\n  const handleSaveTask = async (taskData, taskId = null) => {\n    try {\n      let response;\n      if (taskId) {\n        response = await apiService.updateTask(taskId, taskData);\n      } else {\n        response = await apiService.createTask(taskData);\n      }\n      if (response.success) {\n        setError(null);\n        setShowTaskModal(false);\n        setEditingTask(null);\n        fetchData(); // Refresh data\n      } else {\n        setError(response.message);\n      }\n    } catch (err) {\n      setError(err.message || \"Failed to save task.\");\n    }\n  };\n\n  const handleDeleteTask = async (taskId) => {\n    if (window.confirm(\"Are you sure you want to delete this task?\")) {\n      try {\n        const response = await apiService.deleteTask(taskId);\n        if (response.success) {\n          setError(null);\n          fetchData(); // Refresh data\n        } else {\n          setError(response.message);\n        }\n      } catch (err) {\n        setError(err.message || \"Failed to delete task.\");\n      }\n    }\n  };\n\n  const handleAssignTask = async (taskId, userId) => {\n    try {\n      const response = await apiService.assignTask(taskId, userId);\n      if (response.success) {\n        setError(null);\n        fetchData();\n      } else {\n        setError(response.message);\n      }\n    } catch (err) {\n      setError(err.message || \"Failed to assign task.\");\n    }\n  };\n\n  const handleUnassignTask = async (taskId) => {\n    if (window.confirm(\"Are you sure you want to unassign this task?\")) {\n      try {\n        const response = await apiService.unassignTask(taskId);\n        if (response.success) {\n          setError(null);\n          fetchData();\n        } else {\n          setError(response.message);\n        }\n      } catch (err) {\n        setError(err.message || \"Failed to unassign task.\");\n      }\n    }\n  };\n\n  const handleCreateAndAssignTask = async (taskData) => {\n    try {\n      const response = await apiService.createTask(taskData); // This endpoint should handle assignment if assignedTo is present\n      if (response.success) {\n        setError(null);\n        setShowTaskAssignModal(false);\n        fetchData();\n      } else {\n        setError(response.message);\n      }\n    } catch (err) {\n      setError(err.message || \"Failed to create and assign task.\");\n    }\n  };\n\n  const handleSaveUser = async (userData, userId = null) => {\n    try {\n      let response;\n      if (userId) {\n        response = await apiService.updateUser(userId, userData);\n      } else {\n        response = await apiService.createUser(userData);\n      }\n      if (response.success) {\n        setError(null);\n        setShowUserModal(false);\n        setEditingUser(null);\n        fetchData(); // Refresh data\n      } else {\n        setError(response.message);\n      }\n    } catch (err) {\n      setError(err.message || \"Failed to save user.\");\n    }\n  };\n\n  const handleDeleteUser = async (userId) => {\n    if (window.confirm(\"Are you sure you want to delete this user?\")) {\n      try {\n        const response = await apiService.deleteUser(userId);\n        if (response.success) {\n          setError(null);\n          fetchData(); // Refresh data\n        } else {\n          setError(response.message);\n        }\n      } catch (err) {\n        setError(err.message || \"Failed to delete user.\");\n      }\n    }\n  };\n\n  const handleSendEmail = async (emailData) => {\n    try {\n      const response = await apiService.sendEmail(emailData);\n      if (response.success) {\n        setError(null);\n        setShowEmailModal(false);\n        alert(\"Email sent successfully!\");\n      } else {\n        setError(response.message);\n      }\n    } catch (err) {\n      setError(err.message || \"Failed to send email.\");\n    }\n  };\n\n  const renderOverview = () => (\n    <div className=\"space-y-6\">\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6\">\n        <div className=\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\n                {stats.totalTasks}\n              </p>\n              <p className=\"text-gray-600 dark:text-gray-300\">Total Tasks</p>\n            </div>\n            <ListTodo className=\"text-blue-500\" size={24} />\n          </div>\n        </div>\n        <div className=\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">\n                {stats.pendingTasks}\n              </p>\n              <p className=\"text-gray-600 dark:text-gray-300\">Pending Tasks</p>\n            </div>\n            <Clock className=\"text-orange-500\" size={24} />\n          </div>\n        </div>\n        <div className=\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n                {stats.completedTasks}\n              </p>\n              <p className=\"text-gray-600 dark:text-gray-300\">\n                Completed Tasks\n              </p>\n            </div>\n            <CheckCircle className=\"text-green-500\" size={24} />\n          </div>\n        </div>\n        <div\n          className=\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors\"\n          onClick={() =>\n            subAdminPermissions.canViewAllUsers && setActiveView(\"manage-users\")\n          }\n        >\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">\n                {stats.totalUsers}\n              </p>\n              <p className=\"text-gray-600 dark:text-gray-300\">Total Users</p>\n            </div>\n            <Users className=\"text-purple-500\" size={24} />\n          </div>\n        </div>\n        <div\n          className=\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors\"\n          onClick={() =>\n            subAdminPermissions.canViewAllUsers &&\n            setActiveView(\"unassigned-users\")\n          }\n        >\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-2xl font-bold text-red-600 dark:text-red-400\">\n                {stats.unassignedUsers}\n              </p>\n              <p className=\"text-gray-600 dark:text-gray-300\">\n                Unassigned Users\n              </p>\n            </div>\n            <UserX className=\"text-red-500\" size={24} />\n          </div>\n        </div>\n      </div>\n\n      {/* Recent Activity */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <div className=\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\">\n          <h3 className=\"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4\">\n            Recent Users\n          </h3>\n          <div className=\"space-y-3\">\n            {users.slice(0, 5).map((user) => (\n              <div key={user._id} className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center\">\n                    <span className=\"text-white text-sm font-semibold\">\n                      {user.name.charAt(0)}\n                    </span>\n                  </div>\n                  <div>\n                    <p className=\"font-medium text-gray-800 dark:text-gray-100\">\n                      {user.name}\n                    </p>\n                    <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                      {user.email}\n                    </p>\n                  </div>\n                </div>\n                <span\n                  className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    user.role === \"admin\"\n                      ? \"bg-red-100 text-red-600 dark:bg-red-800 dark:text-red-200\"\n                      : user.role === \"subadmin\"\n                      ? \"bg-blue-100 text-blue-600 dark:bg-blue-800 dark:text-blue-200\"\n                      : \"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-200\"\n                  }`}\n                >\n                  {user.role}\n                </span>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600\">\n          <h3 className=\"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4\">\n            Recent Tasks\n          </h3>\n          <div className=\"space-y-3\">\n            {tasks.slice(0, 5).map((task) => (\n              <div key={task._id} className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"font-medium text-gray-800 dark:text-gray-100\">\n                    {task.title}\n                  </p>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                    Assigned to: {task.assignedTo?.name || \"Unassigned\"}\n                  </p>\n                </div>\n                <span\n                  className={`px-2 py-1 rounded-full text-xs font-medium transition-colors ${\n                    task.completed\n                      ? \"bg-green-100 text-green-600 dark:bg-green-800 dark:text-green-200\"\n                      : \"bg-orange-100 text-orange-600 dark:bg-orange-800 dark:text-orange-200\"\n                  }`}\n                >\n                  {task.completed ? \"Completed\" : \"Pending\"}\n                </span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  const renderManageTasks = () => (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4\">\n        <h2 className=\"text-2xl font-bold text-gray-800 dark:text-gray-100\">\n          Manage Tasks\n        </h2>\n        <div className=\"flex flex-wrap gap-2\">\n          <div className=\"flex space-x-2\">\n            {[\"all\", \"today\", \"week\", \"month\", \"deadline-missed\"].map(\n              (timeline) => (\n                <button\n                  key={timeline}\n                  onClick={() => setActiveTimeline(timeline)}\n                  className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n                    activeTimeline === timeline\n                      ? \"bg-purple-600 text-white\"\n                      : \"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600\"\n                  }`}\n                >\n                  {timeline.charAt(0).toUpperCase() +\n                    timeline.slice(1).replace(\"-\", \" \")}\n                </button>\n              )\n            )}\n          </div>\n          <div className=\"flex space-x-2\">\n            {[\"all\", \"pending\", \"completed\"].map((filter) => (\n              <button\n                key={filter}\n                onClick={() => setActiveTaskFilter(filter)}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n                  activeTaskFilter === filter\n                    ? \"bg-blue-600 text-white\"\n                    : \"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600\"\n                }`}\n              >\n                {filter.charAt(0).toUpperCase() + filter.slice(1)}\n              </button>\n            ))}\n          </div>\n          {activeTimeline === \"deadline-missed\" &&\n            subAdminPermissions.canSendEmails && (\n              <button\n                onClick={() => {\n                  const missedDeadlineUsers = filteredTasks\n                    .filter((task) => task.assignedTo?.email)\n                    .map((task) => task.assignedTo.email);\n                  setEmailRecipients([...new Set(missedDeadlineUsers)]); // Unique emails\n                  setShowEmailModal(true);\n                }}\n                className=\"px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-medium hover:bg-red-600 transition-colors\"\n              >\n                <Mail size={16} className=\"inline-block mr-2\" />\n                Email Users\n              </button>\n            )}\n        </div>\n      </div>\n\n      <div className=\"bg-white dark:bg-gray-700 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 p-6\">\n        {filteredTasks.length === 0 ? (\n          <p className=\"text-gray-600 dark:text-gray-300 text-center\">\n            No tasks found for this filter.\n          </p>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-600\">\n              <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Title\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Assigned To\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Due Date\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Priority\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Actions\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600\">\n                {filteredTasks.map((task) => (\n                  <tr key={task._id}>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100\">\n                      {task.title}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\">\n                      {task.assignedTo?.name || \"Unassigned\"}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\">\n                      {task.dueDate\n                        ? format(new Date(task.dueDate), \"PPP\")\n                        : \"N/A\"}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\">\n                      {task.priority}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                          task.completed\n                            ? \"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100\"\n                            : \"bg-orange-100 text-orange-800 dark:bg-orange-800 dark:text-orange-100\"\n                        }`}\n                      >\n                        {task.completed ? \"Completed\" : \"Pending\"}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                      {(subAdminPermissions.canEditAllTasks ||\n                        (task.assignedTo &&\n                          subAdminPermissions.canEditSpecificUsers?.includes(\n                            task.assignedTo._id\n                          ))) && (\n                        <>\n                          <button\n                            onClick={() => {\n                              setEditingTask(task);\n                              setShowTaskModal(true);\n                            }}\n                            className=\"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 mr-3\"\n                            title=\"Edit Task\"\n                          >\n                            <Edit size={18} />\n                          </button>\n                          <button\n                            onClick={() => handleDeleteTask(task._id)}\n                            className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 mr-3\"\n                            title=\"Delete Task\"\n                          >\n                            <Trash2 size={18} />\n                          </button>\n                          {task.assignedTo && (\n                            <button\n                              onClick={() => handleUnassignTask(task._id)}\n                              className=\"text-yellow-600 hover:text-yellow-900 dark:text-yellow-400 dark:hover:text-yellow-200\"\n                              title=\"Unassign Task\"\n                            >\n                              <UserMinus size={18} />\n                            </button>\n                          )}\n                        </>\n                      )}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n\n  const renderManageUsers = () => (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center mb-4\">\n        <h2 className=\"text-2xl font-bold text-gray-800 dark:text-gray-100\">\n          Manage Users\n        </h2>\n        {subAdminPermissions.canEditAllUsers && (\n          <button\n            onClick={() => {\n              setEditingUser(null);\n              setShowUserModal(true);\n            }}\n            className=\"px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700 transition-colors\"\n          >\n            <UserPlus size={16} className=\"inline-block mr-2\" />\n            Add New User\n          </button>\n        )}\n      </div>\n\n      <div className=\"bg-white dark:bg-gray-700 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 p-6\">\n        {users.length === 0 ? (\n          <p className=\"text-gray-600 dark:text-gray-300 text-center\">\n            No users found.\n          </p>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-600\">\n              <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Name\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Email\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Role\n                  </th>\n                  <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                    Actions\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600\">\n                {users.map((user) => (\n                  <tr key={user._id}>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100\">\n                      {user.name}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\">\n                      {user.email}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                          user.role === \"admin\"\n                            ? \"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100\"\n                            : user.role === \"subadmin\"\n                            ? \"bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100\"\n                            : \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\"\n                        }`}\n                      >\n                        {user.role}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                      {(subAdminPermissions.canEditAllUsers ||\n                        subAdminPermissions.canEditSpecificUsers?.includes(\n                          user._id\n                        )) && (\n                        <>\n                          <button\n                            onClick={() => {\n                              setEditingUser(user);\n                              setShowUserModal(true);\n                            }}\n                            className=\"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 mr-3\"\n                            title=\"Edit User\"\n                          >\n                            <Edit size={18} />\n                          </button>\n                          {user.role !== \"admin\" && ( // Admins cannot delete other admins\n                            <button\n                              onClick={() => handleDeleteUser(user._id)}\n                              className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200\"\n                              title=\"Delete User\"\n                            >\n                              <Trash2 size={18} />\n                            </button>\n                          )}\n                        </>\n                      )}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600 dark:text-gray-300\">\n            Loading subadmin dashboard...\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex\">\n      {/* Error Display */}\n      {error && (\n        <div className=\"fixed top-4 right-4 z-50 bg-red-500 text-white p-4 rounded-lg shadow-lg max-w-sm\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm\">{error}</span>\n            <button\n              onClick={() => setError(null)}\n              className=\"ml-2 text-white hover:text-gray-200\"\n            >\n              <X size={16} />\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Mobile Sidebar Overlay */}\n      {sidebarOpen && (\n        <div\n          className=\"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden\"\n          onClick={() => setSidebarOpen(false)}\n        />\n      )}\n\n      {/* Sidebar */}\n      <div\n        className={`fixed lg:static inset-y-0 left-0 z-50 w-64 bg-white dark:bg-gray-800 shadow-sm border-r border-gray-200 dark:border-gray-700 transform ${\n          sidebarOpen ? \"translate-x-0\" : \"-translate-x-full\"\n        } lg:translate-x-0 transition-transform duration-300 ease-in-out`}\n      >\n        <div className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center\">\n                <span className=\"text-white font-bold text-sm\">T</span>\n              </div>\n              <span className=\"text-xl font-bold text-gray-800 dark:text-gray-100\">\n                SubAdmin Panel\n              </span>\n            </div>\n            <button\n              onClick={() => setSidebarOpen(false)}\n              className=\"lg:hidden text-gray-500 hover:text-gray-700\"\n            >\n              <X size={24} />\n            </button>\n          </div>\n\n          <div className=\"mb-6\">\n            <div className=\"flex items-center space-x-3 mb-2\">\n              <div className=\"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center\">\n                <span className=\"text-white font-semibold\">\n                  {user?.name?.charAt(0)}\n                </span>\n              </div>\n              <div>\n                <p className=\"font-medium text-gray-800 dark:text-gray-100\">\n                  {user?.name}\n                </p>\n                <p className=\"text-sm text-purple-500\">SubAdmin</p>\n              </div>\n            </div>\n          </div>\n\n          <nav className=\"space-y-2\">\n            <button\n              onClick={() => setActiveView(\"overview\")}\n              className={`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${\n                activeView === \"overview\"\n                  ? \"bg-purple-50 text-purple-600 dark:bg-purple-900 dark:text-purple-300\"\n                  : \"text-gray-600 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700\"\n              }`}\n            >\n              <Home size={20} />\n              <span>Overview</span>\n            </button>\n            {(subAdminPermissions.canViewAllTasks ||\n              subAdminPermissions.canViewSpecificUsers?.length > 0) && (\n              <button\n                onClick={() => setActiveView(\"manage-tasks\")}\n                className={`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${\n                  activeView === \"manage-tasks\"\n                    ? \"bg-purple-50 text-purple-600 dark:bg-purple-900 dark:text-purple-300\"\n                    : \"text-gray-600 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700\"\n                }`}\n              >\n                <ListTodo size={20} />\n                <span>Manage Tasks</span>\n              </button>\n            )}\n            {(subAdminPermissions.canViewAllUsers ||\n              subAdminPermissions.canViewSpecificUsers?.length > 0) && (\n              <button\n                onClick={() => setActiveView(\"manage-users\")}\n                className={`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${\n                  activeView === \"manage-users\"\n                    ? \"bg-purple-50 text-purple-600 dark:bg-purple-900 dark:text-purple-300\"\n                    : \"text-gray-600 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700\"\n                }`}\n              >\n                <Users size={20} />\n                <span>Manage Users</span>\n              </button>\n            )}\n            {(subAdminPermissions.canEditAllTasks ||\n              subAdminPermissions.canEditSpecificUsers?.length > 0) && (\n              <button\n                onClick={() => setShowTaskAssignModal(true)}\n                className=\"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-green-600 hover:bg-green-50 dark:text-green-400 dark:hover:bg-green-900\"\n              >\n                <PlusCircle size={20} />\n                <span>Assign New Task</span>\n              </button>\n            )}\n          </nav>\n\n          <div className=\"mt-8\">\n            <button\n              onClick={logout}\n              className=\"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900\"\n            >\n              <LogOut size={20} />\n              <span>Logout</span>\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"flex-1 p-6\">\n        {/* Mobile Header */}\n        <div className=\"flex items-center justify-between mb-6 lg:hidden\">\n          <button\n            onClick={() => setSidebarOpen(true)}\n            className=\"text-gray-600 hover:text-gray-800 dark:text-gray-300 dark:hover:text-gray-100\"\n          >\n            <Menu size={24} />\n          </button>\n          <h1 className=\"text-xl font-bold text-gray-800 dark:text-gray-100\">\n            SubAdmin Dashboard\n          </h1>\n          <div className=\"w-6\"></div>\n        </div>\n        {/* Content */}\n        {activeView === \"overview\" && renderOverview()}\n        {activeView === \"manage-tasks\" && renderManageTasks()}\n        {activeView === \"manage-users\" && renderManageUsers()}\n        {activeView === \"unassigned-users\" &&\n          subAdminPermissions.canViewAllUsers &&\n          renderManageUsers()}{\" \"}\n        {/* Re-use user management for unassigned */}\n      </div>\n\n      {showTaskModal && (\n        <TaskModal\n          task={editingTask}\n          users={users.filter((u) => u.role === \"user\")} // Only assign to regular users\n          onClose={() => {\n            setShowTaskModal(false);\n            setEditingTask(null);\n          }}\n          onSave={handleSaveTask}\n        />\n      )}\n\n      {showTaskAssignModal && (\n        <TaskAssignModal\n          users={users.filter((u) => u.role === \"user\")} // Only assign to regular users\n          onClose={() => setShowTaskAssignModal(false)}\n          onAssign={handleCreateAndAssignTask}\n        />\n      )}\n\n      {showUserModal && (\n        <UserModal\n          user={editingUser}\n          onClose={() => {\n            setShowUserModal(false);\n            setEditingUser(null);\n          }}\n          onSave={handleSaveUser}\n        />\n      )}\n\n      {showEmailModal && (\n        <EmailModal\n          recipients={emailRecipients}\n          onClose={() => setShowEmailModal(false)}\n          onSend={handleSendEmail}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default SubAdminDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}